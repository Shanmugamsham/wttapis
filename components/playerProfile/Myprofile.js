const data=[{
    "playerProfile": {
        "ittfID": "1001",
        "playerGivenName": "WANG",
        "playerFamilyName": "Chuquin",
        "country": "China",
        "countryCode": "CHN",
        "age": 28,
        "nationality": "Chinese", 
        "memberAssociation": "Chinese Table Tennis Association",
        "dateOfBirth":new Date("1995-06-15").toJSON(),
        "gender": "Male",
        "playingStyle": "Right-handed",
        "profilePicture": "https://example.com/images/player_wang_chuquin.jpg",
        "flag": "https://flagcdn.com/w320/cn.png", 
        "ranking": {
            "currentRanking": 1,
            "rankingPoints": 7925,
            "lastUpdated": new Date("2024-05-01").toJSON()
        }
    },
    "contacts": {
            "phone": "+86 123 456 7890",
            "emergencyNumber": "+86 987 654 3210",
            "primaryEmail": "wang.chuquin@example.com",
            "secondaryEmail": "chuquin.wang@backupmail.com",
            "whatsapp": "+86 123 456 7890",
            "agent": {
                "agencyName": "Top Sports Management",
                "agentPhone": "+86 112 233 4455",
                "agentEmail": "agent@example.com"
            }},
    "personalDetails":{
        "nickname": "WANG",
        "educationLevel": "Master's",
        "languagesSpoken": [
            "Tamil",
            "English"
        ],
        "habits": [
            "Reading",
            "Playing Table Tennis",
            "Listening to Music"
        ],
        "favoriteMusic": [
            "Classical",
            "Jazz",
            "Pop",
            "Rock"
        ],
    },
    "sportsDetails": {
        "academy": "TT Academy",
        "coachName": "John Doe",
        "league": "Chinese Table Tennis Association",
        "country": "china",
        "currentSponsor": "Sports Gear Co.",
        "playingEquipment": {
            "bat": {
                "brand": "Butterfly",
                "model": "Timo Boll ALC"
            },
            "rubber": {
                "forehand": "Tenergy 05",
                "backhand": "Tenergy 05 FX"
            },
            "table": "Stiga Pro Carbon"
        },
        "uniqueFacts": [
            "Ranked top 10 in the state",
            "Participated in national championships",
            "Has a 90% win rate in local tournaments"
        ],
        "playingHand": "Right",
        "grip": "Shakehand",
        "playingStyle": "Offensive"
    }
    

},{
    "playerProfile": {
        "ittfID": "1002",
        "playerGivenName": "Fan",
      "playerFamilyName": "Zhendong",
        "country": "China",
        "countryCode": "CHN",
        "age": 28,
        "nationality": "Chinese", 
        "memberAssociation": "Chinese Table Tennis Association",
        "dateOfBirth":new Date("1995-06-15").toJSON(),
        "gender": "Male",
        "playingStyle": "Right-handed",
        "profilePicture": "https://example.com/images/player_wang_chuquin.jpg",
        "flag": "https://flagcdn.com/w320/cn.png", 
        "ranking": {
            "currentRanking": 1,
            "rankingPoints": 7925,
            "lastUpdated": new Date("2024-05-01").toJSON()
        }
    },
    "contacts": {
            "phone": "+86 123 456 7890",
            "emergencyNumber": "+86 987 654 3210",
            "primaryEmail": "wang.chuquin@example.com",
            "secondaryEmail": "chuquin.wang@backupmail.com",
            "whatsapp": "+86 123 456 7890",
            "agent": {
                "agencyName": "Top Sports Management",
                "agentPhone": "+86 112 233 4455",
                "agentEmail": "agent@example.com"
            }},
    "personalDetails":{
        "nickname": "WANG",
        "educationLevel": "Master's",
        "languagesSpoken": [
            "Tamil",
            "English"
        ],
        "habits": [
            "Reading",
            "Playing Table Tennis",
            "Listening to Music"
        ],
        "favoriteMusic": [
            "Classical",
            "Jazz",
            "Pop",
            "Rock"
        ],
    },
    "sportsDetails": {
        "academy": "TT Academy",
        "coachName": "John Doe",
        "league": "Chinese Table Tennis Association",
        "country": "china",
        "currentSponsor": "Sports Gear Co.",
        "playingEquipment": {
            "bat": {
                "brand": "Butterfly",
                "model": "Timo Boll ALC"
            },
            "rubber": {
                "forehand": "Tenergy 05",
                "backhand": "Tenergy 05 FX"
            },
            "table": "Stiga Pro Carbon"
        },
        "uniqueFacts": [
            "Ranked top 10 in the state",
            "Participated in national championships",
            "Has a 90% win rate in local tournaments"
        ],
        "playingHand": "Right",
        "grip": "Shakehand",
        "playingStyle": "Offensive"
    }
    

},{
    "playerProfile": {
        "ittfID": "1003",
        "playerGivenName": "Tomokazu",
        "playerFamilyName": "Harimoto",
        "country": "China",
        "countryCode": "CHN",
        "age": 28,
        "nationality": "Chinese", 
        "memberAssociation": "Chinese Table Tennis Association",
        "dateOfBirth":new Date("1995-06-15").toJSON(),
        "gender": "Male",
        "playingStyle": "Right-handed",
        "profilePicture": "https://example.com/images/player_wang_chuquin.jpg",
        "flag": "https://flagcdn.com/w320/cn.png", 
        "ranking": {
            "currentRanking": 1,
            "rankingPoints": 7925,
            "lastUpdated": new Date("2024-05-01").toJSON()
        }
    },
    "contacts": {
            "phone": "+86 123 456 7890",
            "emergencyNumber": "+86 987 654 3210",
            "primaryEmail": "wang.chuquin@example.com",
            "secondaryEmail": "chuquin.wang@backupmail.com",
            "whatsapp": "+86 123 456 7890",
            "agent": {
                "agencyName": "Top Sports Management",
                "agentPhone": "+86 112 233 4455",
                "agentEmail": "agent@example.com"
            }},
    "personalDetails":{
        "nickname": "WANG",
        "educationLevel": "Master's",
        "languagesSpoken": [
            "Tamil",
            "English"
        ],
        "habits": [
            "Reading",
            "Playing Table Tennis",
            "Listening to Music"
        ],
        "favoriteMusic": [
            "Classical",
            "Jazz",
            "Pop",
            "Rock"
        ],
    },
    "sportsDetails": {
        "academy": "TT Academy",
        "coachName": "John Doe",
        "league": "Chinese Table Tennis Association",
        "country": "china",
        "currentSponsor": "Sports Gear Co.",
        "playingEquipment": {
            "bat": {
                "brand": "Butterfly",
                "model": "Timo Boll ALC"
            },
            "rubber": {
                "forehand": "Tenergy 05",
                "backhand": "Tenergy 05 FX"
            },
            "table": "Stiga Pro Carbon"
        },
        "uniqueFacts": [
            "Ranked top 10 in the state",
            "Participated in national championships",
            "Has a 90% win rate in local tournaments"
        ],
        "playingHand": "Right",
        "grip": "Shakehand",
        "playingStyle": "Offensive"
    }
    

}]
exports.playerprofile = (req, res) => {
    const ittfID = req.query.ittfID;   
    const country = req.query.country; 
    const field = req.query.field; 

    
    if (!ittfID) {
        return res.status(200).json(data);
    }


    
    const player = data.find(p => p.playerProfile.ittfID === ittfID);

  
    if (!player) {
        return res.status(404).json({ message: 'Player not found' });
    }


    if (country && player.playerProfile.country.toLowerCase() !== country.toLowerCase()) {
        return res.status(404).json({ message: 'Player from specified country not found' });
    }

    
    const response = {};

    if (field) {
        const requestedTypes = field.split(',');  

        requestedTypes.forEach(type => {
            switch (type.trim().toLowerCase()) {
                case 'playerprofile':
                    response.playerProfile = player.playerProfile;
                    break;
                case 'contacts':
                    response.contacts = player.contacts;
                    break;
                case 'personaldetails':
                    response.personalDetails = player.personalDetails;
                    break;
                case 'sportsdetail':
                    response.sportsDetails = player.sportsDetails;
                    break;
                default:
                   
                    break;
            }
        });
    }

   
    if (!field || Object.keys(response).length === 0) {
        return res.json(player);
    }

    
    return res.json(response);
};